(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[631],{38072:function(e,t,r){Promise.resolve().then(r.bind(r,40660))},40660:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return x}});var s=r(3827),a=r(64090),n=r(8792),i=r(53879),d=r(4697),l=r(18025),c=r(70094),o=r(50489),u=r(98998),h=r(70699),m=r(47907);function x(){let e=(0,m.useRouter)(),[t,r]=(0,a.useState)([]),[x,p]=(0,a.useState)([]),[f,y]=(0,a.useState)(""),[g,b]=(0,a.useState)(""),[j,v]=(0,a.useState)([]),[k,N]=(0,a.useState)(""),[w,S]=(0,a.useState)(1),[Z,I]=(0,a.useState)(null),[A,_]=(0,a.useState)(!1),[z,C]=(0,a.useState)(""),[P,M]=(0,a.useState)("");(0,a.useEffect)(()=>{T(),q()},[]),(0,a.useEffect)(()=>{k&&f?R(k,f):I(null)},[k,f]);let T=async()=>{let e=await fetch("/api/branches");e.ok&&r(await e.json())},q=async()=>{let e=await fetch("/api/products?search=");e.ok&&p(await e.json())},R=async(e,t)=>{let r=await fetch("/api/inventory?productId=".concat(e,"&branchId=").concat(t));if(r.ok){let e=await r.json();I(void 0!==e.quantity?e.quantity:0)}else I(0)},B=e=>{let t=[...j];t.splice(e,1),v(t)},E=async()=>{if(!f||!g){C("Please select both source and destination branches");return}if(f===g){C("Source and destination branches must be different");return}if(0===j.length){C("Please add at least one item to transfer");return}_(!0),C("");try{let t={fromBranchId:parseInt(f),toBranchId:parseInt(g),items:j.map(e=>({productId:e.productId,quantity:e.quantity})),userId:1},r=await fetch("/api/inventory/transfer",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(r.ok)M("Transfer completed successfully!"),setTimeout(()=>{e.push("/inventory")},2e3);else{let e=await r.json();C(e.error||"Transfer failed")}}catch(e){console.error(e),C("An error occurred during transfer")}finally{_(!1)}};return(0,s.jsxs)("div",{style:{padding:"2rem",maxWidth:"1000px",margin:"0 auto"},children:[(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsxs)(n.default,{href:"/inventory",className:"text-muted hover:text-primary flex items-center gap-2 mb-2 text-sm transition-colors",children:[(0,s.jsx)(i.Z,{size:16})," Back to Inventory"]}),(0,s.jsx)("h1",{className:"h3",children:"Inter-Branch Transfer"}),(0,s.jsx)("p",{className:"text-muted",children:"Move stock between branches"})]}),(0,s.jsxs)("div",{className:"grid gap-6",children:[(0,s.jsxs)("div",{className:"card",children:[(0,s.jsxs)("h2",{className:"text-lg font-bold mb-4 flex items-center gap-2",children:[(0,s.jsx)(d.Z,{size:20,className:"text-primary"}),"Transfer Details"]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-8 items-center",children:[(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)("label",{className:"text-sm font-bold text-muted",children:"From Branch (Source)"}),(0,s.jsxs)("select",{className:"input",style:{width:"100%",padding:"0.75rem",borderRadius:"var(--radius-sm)",border:"1px solid var(--border)"},value:f,onChange:e=>{y(e.target.value),v([])},children:[(0,s.jsx)("option",{value:"",children:"Select Source Branch"}),t.map(e=>(0,s.jsx)("option",{value:e.branch_id,children:e.branch_name},e.branch_id))]})]}),(0,s.jsx)("div",{className:"flex justify-center",children:(0,s.jsx)(l.Z,{className:"text-muted",size:24})}),(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)("label",{className:"text-sm font-bold text-muted",children:"To Branch (Destination)"}),(0,s.jsxs)("select",{className:"input",style:{width:"100%",padding:"0.75rem",borderRadius:"var(--radius-sm)",border:"1px solid var(--border)"},value:g,onChange:e=>b(e.target.value),children:[(0,s.jsx)("option",{value:"",children:"Select Destination Branch"}),t.map(e=>(0,s.jsx)("option",{value:e.branch_id,disabled:e.branch_id.toString()===f,children:e.branch_name},e.branch_id))]})]})]})]}),f&&(0,s.jsxs)("div",{className:"card",children:[(0,s.jsx)("h2",{className:"text-lg font-bold mb-4",children:"Add Items"}),(0,s.jsxs)("div",{className:"flex gap-4 items-end mb-6 p-4 rounded-lg",style:{background:"var(--surface-hover)"},children:[(0,s.jsxs)("div",{className:"flex-1 grid gap-2",children:[(0,s.jsx)("label",{className:"text-sm font-bold text-muted",children:"Product"}),(0,s.jsxs)("select",{className:"input",style:{padding:"0.6rem",border:"1px solid var(--border)",borderRadius:"var(--radius-sm)"},value:k,onChange:e=>N(e.target.value),children:[(0,s.jsx)("option",{value:"",children:"Select Product"}),x.map(e=>(0,s.jsxs)("option",{value:e.product_id,children:[e.name," (",e.sku,")"]},e.product_id))]})]}),(0,s.jsxs)("div",{className:"w-32 grid gap-2",children:[(0,s.jsx)("label",{className:"text-sm font-bold text-muted",children:"Quantity"}),(0,s.jsx)("input",{type:"number",className:"input",style:{padding:"0.6rem",border:"1px solid var(--border)",borderRadius:"var(--radius-sm)",width:"100%"},min:"1",value:w,onChange:e=>S(parseInt(e.target.value))})]}),(0,s.jsxs)("div",{className:"w-32 grid gap-2",children:[(0,s.jsx)("label",{className:"text-sm font-bold text-muted",children:"Stock"}),(0,s.jsx)("div",{className:"text-sm font-medium",style:{padding:"0.6rem",color:0===Z?"var(--danger)":"var(--text-main)"},children:null!==Z?"".concat(Z," Avail."):"-"})]}),(0,s.jsxs)("button",{className:"btn btn-secondary",onClick:()=>{if(!k||!w||!Z||w<=0)return;if(w>Z){alert("Insufficient stock. Max available: ".concat(Z));return}if(j.find(e=>e.productId===parseInt(k))){alert("Item already added to transfer list");return}let e=x.find(e=>e.product_id===parseInt(k));e&&(v([...j,{productId:e.product_id,productName:e.name,quantity:w,maxStock:Z}]),N(""),S(1),I(null))},disabled:!k||!Z||w<=0||w>Z,children:[(0,s.jsx)(c.Z,{size:18})," Add"]})]}),j.length>0?(0,s.jsxs)("table",{style:{width:"100%"},children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{style:{textAlign:"left",padding:"0.5rem",fontSize:"0.85rem"},children:"Product"}),(0,s.jsx)("th",{style:{textAlign:"left",padding:"0.5rem",fontSize:"0.85rem"},children:"Quantity"}),(0,s.jsx)("th",{style:{textAlign:"right",padding:"0.5rem",fontSize:"0.85rem"},children:"Action"})]})}),(0,s.jsx)("tbody",{children:j.map((e,t)=>(0,s.jsxs)("tr",{style:{borderTop:"1px solid var(--border)"},children:[(0,s.jsx)("td",{style:{padding:"0.75rem"},children:e.productName}),(0,s.jsx)("td",{style:{padding:"0.75rem"},children:e.quantity}),(0,s.jsx)("td",{style:{padding:"0.75rem",textAlign:"right"},children:(0,s.jsx)("button",{onClick:()=>B(t),className:"text-danger hover:text-danger-dark",children:(0,s.jsx)(o.Z,{size:16})})})]},t))})]}):(0,s.jsx)("div",{className:"text-center text-muted text-sm py-4",children:"No items added yet"})]}),z&&(0,s.jsxs)("div",{className:"flex items-center gap-2 p-4 text-danger bg-red-50 rounded-lg border border-red-100",style:{background:"rgba(239, 68, 68, 0.1)"},children:[(0,s.jsx)(u.Z,{size:20}),z]}),P&&(0,s.jsxs)("div",{className:"flex items-center gap-2 p-4 text-success bg-green-50 rounded-lg border border-green-100",style:{background:"rgba(16, 185, 129, 0.1)"},children:[(0,s.jsx)(u.Z,{size:20}),P]}),(0,s.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,s.jsx)(n.default,{href:"/inventory",className:"btn btn-ghost",children:"Cancel"}),(0,s.jsx)("button",{className:"btn btn-primary",onClick:E,disabled:A||0===j.length,children:A?"Processing...":(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(h.Z,{size:18})," Confirm Transfer"]})})]})]})]})}},87461:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var s=r(64090),a={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),i=(e,t)=>{let r=(0,s.forwardRef)((r,i)=>{let{color:d="currentColor",size:l=24,strokeWidth:c=2,absoluteStrokeWidth:o,className:u="",children:h,...m}=r;return(0,s.createElement)("svg",{ref:i,...a,width:l,height:l,stroke:d,strokeWidth:o?24*Number(c)/Number(l):c,className:["lucide","lucide-".concat(n(e)),u].join(" "),...m},[...t.map(e=>{let[t,r]=e;return(0,s.createElement)(t,r)}),...Array.isArray(h)?h:[h]])});return r.displayName="".concat(e),r}},98998:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(87461).Z)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},53879:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(87461).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},18025:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(87461).Z)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]])},4697:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(87461).Z)("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]])},70094:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(87461).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},70699:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(87461).Z)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]])},50489:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(87461).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},8792:function(e,t,r){"use strict";r.d(t,{default:function(){return a.a}});var s=r(25250),a=r.n(s)},47907:function(e,t,r){"use strict";var s=r(15313);r.o(s,"usePathname")&&r.d(t,{usePathname:function(){return s.usePathname}}),r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}}),r.o(s,"useSearchParams")&&r.d(t,{useSearchParams:function(){return s.useSearchParams}})}},function(e){e.O(0,[250,971,69,744],function(){return e(e.s=38072)}),_N_E=e.O()}]);